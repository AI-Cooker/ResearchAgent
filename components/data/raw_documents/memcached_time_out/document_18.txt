memcached timeout | LiteSpeed Support Forums
Solutions
Products
Support
Partners
Open Source
     
  
Menu
Home
Forums
New posts
Search forums
What's new
New posts
New profile posts
Latest activity
Members
Current visitors
New profile posts
Search profile posts
Log in
Register
What's new
Search
Search
Everywhere
Threads
This forum
This thread
Search titles only
By:
Search
Advanced search…
New posts
Search forums
			Menu
			
						Log in
					
							Register
						
Home
Forums
LiteSpeed Enterprise Web Server
General Support
JavaScript is disabled. For a better experience, please enable JavaScript in your browser before proceeding.
memcached timeout
Thread starter
Dani
Start date
Dec 11, 2007
D
Dani
Well-Known Member
Dec 11, 2007
#1
Dec 11, 2007
#1
hey, I'm getting flooded with "Can't connect to localhost:11211, Connection timed out."
I've talked to some memcached 'people' and they ask about maxclients limit and so on, and since apache!=litespeed I'm wondering if it's the 
PHP_LSAPI_MAX_REQUESTS=600
PHP_LSAPI_CHILDREN=150
they are talking about? And if so which should I raise to get PHP not to loose connections with memcached, and also not get 503 errors 
I'm using memcached for php sessions + some stuff on the page, with around 3k online users.
thanks
 
M
mistwang
LiteSpeed Staff
Dec 11, 2007
#2
Dec 11, 2007
#2
The total PHP processes are PHP_LSAPI_CHILDREN * N-CPU license.
You can check the number of lsphp processes in use during your peak hour. You can reduce PHP_LSAPI_CHILDREN a little bit.
 
D
Dani
Well-Known Member
Dec 11, 2007
#3
Dec 11, 2007
#3
ok will do, here is a current log 
I had to turn of session memcache and go with the usual files sessions cause of the timeouts. Any idea on that issue? I'm using pconnect and the memcached is on the localhost.
 
								
									Last edited: Dec 11, 2007
X
xing
LiteSpeed Staff
Dec 11, 2007
#4
Dec 11, 2007
#4
The memcached errors has very little if anything  to do with litespeed. Really. Here is the way to make sure you have everything set up correctly.
1) Make sure memcached exists on a server that has the firewall disabled. Memcached is meant for a lan setup anyways.
2) Make sure you are using a current distro or with proper Linux tcp tunning, ie, short tcp_wait timeouts, etc. The latest versions of redhat/centos are pre-turned out of the box. 
3) Make sure you are using the PECL memcache client. Using the latest stable one.
4) Make sure you are using persistent memcache connections. Using PECL memcache, it's persistent by default.
5) Use subversion to checkout memcached trunk from danga.com and compile memcached from there.
The version for public download is quite old. The trunk version has many optimizations.
There should be no reason memcached cannot handle more than 500+ concurrent connections.
 
D
Dani
Well-Known Member
Dec 11, 2007
#5
Dec 11, 2007
#5
jupp done all that. compiled the latest 2007-12-06: Version 1.2.4 both --enable-threads and without...
But the LS server runs fine now with the extra server for sql  nice work on the updates, keep them coming. The reinstall of the server went great with the licence of LS btw.
 
T
ts77
Well-Known Member
Dec 12, 2007
#6
Dec 12, 2007
#6
maxconn probably referred to the memcached settings.
memcached has a command-line option to define the number of connections allowed/accepted:
		Code:
	
-c <num>      max simultaneous connections, default is 1024
you might want to raise that a bit.
 
D
Dani
Well-Known Member
Dec 12, 2007
#7
Dec 12, 2007
#7
hey ts77, yea I'm aware of -c, I even had it around 3k still no go  don't see a reason to max it out even more.
 
D
Dani
Well-Known Member
Dec 12, 2007
#8
Dec 12, 2007
#8
it was the OS settings that were to blame  didn't think that localhost connections were tracked by ip_conntrack, my bad 
 
								You must log in or register to reply here.
							
Share:
Facebook
Twitter
Google+
Reddit
Pinterest
Tumblr
WhatsApp
Email
Link
Home
Forums
LiteSpeed Enterprise Web Server
General Support
Terms and rules
Privacy policy
Help
Home
RSS
Forum software by XenForo™ © 2010-2018 XenForo Ltd.
 
Top
RESOURCES
Downloads
Benchmarks
Case Studies
Testimonials
Affiliate Program
Media Kit
Glossary
SOLUTIONS
WordPress Hosting
Agencies
Hosting Providers
Site Owners
Anti-DDoS Solutions
One Click in the Cloud
Application Servers
Cluster Managers
Mass Hosting
WEB APP CACHING
WordPress
Magento
Joomla
Prestashop
OpenCart
Drupal
XenForo
Laravel
Shopware
MediaWiki
PRODUCTS
LiteSpeed Web Server
LiteSpeed Web ADC
LSCache Plugins
 
OPEN SOURCE
OpenLiteSpeed
LiteSpeed Memcached
QUIC and HTTP/3 Library
LiteSpeed Server API
SUPPORT
User Manual
Wiki
Documentation
Forum
Submit a Ticket
Premium Support
Video Instructions
COMPANY
About Us
Blog
Pricing
Latest Technologies
Careers
Contact Us
[Get
            
              LiteSpeed For FREE
            Today!]
            Copyright  2013-2023 LiteSpeed Technologies Inc. All Rights Reserved.
            (Privacy Policy)
